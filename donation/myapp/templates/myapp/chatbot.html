{% extends 'myapp/base.html' %}

{% block title %}AI Assistant - Your Smart Helper{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1">
            <!-- Header with AI branding -->
            <div class="ai-header text-center mb-4">
                <div class="ai-logo">ü§ñ‚ú®</div>
                <h1 class="ai-title">Your Personal AI Assistant</h1>
                <p class="ai-subtitle">Intelligent ‚Ä¢ Helpful ‚Ä¢ Available 24/7</p>
            </div>
            
            <div class="chat-card">
                <div class="chat-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center">
                            <div class="bot-status-indicator online"></div>
                            <div>
                                <h3 class="mb-0">AI Assistant</h3>
                                <small class="text-muted">Online ‚Ä¢ Ready to help</small>
                            </div>
                        </div>
                        <div class="chat-actions">
                            <button class="btn btn-sm btn-outline-light" onclick="clearChat()" title="Clear conversation">
                                <i class="fas fa-broom"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-light" onclick="toggleSound()" title="Toggle sound" id="soundToggle">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="chat-container" id="chatContainer" style="height: 500px; overflow-y: auto; margin-bottom: 20px;">
                        <div class="chat-messages" id="chatMessages">
                            <div class="message system">
                                <div class="message-content">
                                    <div class="bot-avatar">ü§ñ</div>
                                    <div class="welcome-message">
                                        <strong>Hello! I'm your AI Assistant</strong><br>
                                        I can help you with questions about:
                                        <ul>
                                            <li>üè´ School fees and payments</li>
                                            <li>üí∞ Donations and fundraising</li>
                                            <li>üïå Waqaf (Islamic endowment)</li>
                                            <li>üìÖ Events and activities</li>
                                            <li>üë®‚Äçüéì Student services</li>
                                        </ul>
                                        <strong>How can I help you today?</strong>
                                    </div>
                                </div>
                                <div class="suggestions-container" id="initialSuggestions">
                                    <button class="suggestion-btn" onclick="sendSuggestion('Check my fees')">Check my fees</button>
                                    <button class="suggestion-btn" onclick="sendSuggestion('Show donation events')">Show donation events</button>
                                    <button class="suggestion-btn" onclick="sendSuggestion('What is waqaf?')">What is waqaf?</button>
                                    <button class="suggestion-btn" onclick="sendSuggestion('Help me')">Help me</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <form id="chatForm" class="mt-3">
                        {% csrf_token %}
                        <div class="input-group">
                            <input type="text" id="userInput" class="form-control" placeholder="Type your question here..." required>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i> Send
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="card mt-4">
                <div class="card-header bg-info text-white">
                    <h3 class="mb-0">Example Questions</h3>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h5>Payment Related</h5>
                            <ul>
                                <li>How can I make a payment?</li>
                                <li>What payment methods are available?</li>
                                <li>How do I get a payment receipt?</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h5>Student Related</h5>
                            <ul>
                                <li>How do I register a new student?</li>
                                <li>What information is needed for student registration?</li>
                                <li>How are student fees calculated?</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
// Global variables for enhanced functionality
let soundEnabled = true;
let isTyping = false;
let conversationCount = 0;
let userPreferences = {
    language: 'en',
    theme: 'default',
    soundEnabled: true
};

document.addEventListener('DOMContentLoaded', function() {
    const chatForm = document.getElementById('chatForm');
    const userInput = document.getElementById('userInput');
    const chatMessages = document.getElementById('chatMessages');
    const chatContainer = document.getElementById('chatContainer');
    
    // Initialize welcome message with personality
    setTimeout(() => {
        showWelcomeMessage();
    }, 500);

    function addMessage(content, isUser = false, suggestions = []) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${isUser ? 'user' : 'system'}`;
        
        const messageContent = document.createElement('div');
        messageContent.className = 'message-content';
        
        if (isUser) {
            messageContent.innerHTML = `<div class="user-avatar">üë§</div><div class="user-message">${content}</div>`;
        } else {
            messageContent.innerHTML = `<div class="bot-avatar">ü§ñ</div><div class="bot-message">${content}</div>`;
        }
        
        messageDiv.appendChild(messageContent);
        
        // Add suggestions if provided
        if (!isUser && suggestions && suggestions.length > 0) {
            const suggestionsDiv = document.createElement('div');
            suggestionsDiv.className = 'suggestions-container';
            
            suggestions.forEach(suggestion => {
                const btn = document.createElement('button');
                btn.className = 'suggestion-btn';
                btn.textContent = suggestion;
                btn.onclick = () => sendSuggestion(suggestion);
                suggestionsDiv.appendChild(btn);
            });
            
            messageDiv.appendChild(suggestionsDiv);
        }
        
        chatMessages.appendChild(messageDiv);
        
        // Scroll to bottom with smooth animation
        setTimeout(() => {
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }, 100);
    }
    
    function sendSuggestion(text) {
        // Add visual feedback
        const suggestionBtns = document.querySelectorAll('.suggestion-btn');
        suggestionBtns.forEach(btn => {
            if (btn.textContent.includes(text.replace(/[üîçüí∞üïåüìÖ‚ùìüè†]/g, '').trim())) {
                btn.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    btn.style.transform = 'scale(1)';
                }, 150);
            }
        });
        
        userInput.value = text;
        chatForm.dispatchEvent(new Event('submit'));
    }
    
    function showWelcomeMessage() {
        // Simulate AI thinking and then show welcome
        addMessage('<div class="typing-indicator"><span></span><span></span><span></span></div>');
        
        setTimeout(() => {
            // Remove typing indicator
            const typingIndicator = document.querySelector('.typing-indicator');
            if (typingIndicator) {
                typingIndicator.closest('.message').remove();
            }
            
            // Send greeting message
            sendMessageToAI('Hello');
        }, 1500);
    }
    
    function clearChat() {
        if (confirm('üóëÔ∏è Are you sure you want to clear the conversation? This will remove all chat history.')) {
            chatMessages.innerHTML = '';
            conversationCount = 0;
            playSound('clear');
            
            // Show cleared message
            setTimeout(() => {
                addMessage('üßπ **Chat cleared!** Ready for a fresh start! How can I help you today? üòä', false, [
                    'üîç Check my fees',
                    'üí∞ Donation events',
                    'üïå What is waqaf?',
                    '‚ùì Help me'
                ]);
            }, 500);
        }
    }
    
    function toggleSound() {
        soundEnabled = !soundEnabled;
        const soundBtn = document.getElementById('soundToggle');
        const icon = soundBtn.querySelector('i');
        
        if (soundEnabled) {
            icon.className = 'fas fa-volume-up';
            soundBtn.title = 'Sound ON - Click to mute';
            playSound('enable');
        } else {
            icon.className = 'fas fa-volume-mute';
            soundBtn.title = 'Sound OFF - Click to enable';
        }
        
        userPreferences.soundEnabled = soundEnabled;
        localStorage.setItem('chatPreferences', JSON.stringify(userPreferences));
    }
    
    function playSound(type) {
        if (!soundEnabled) return;
        
        // Create audio context for sound effects
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            // Different sounds for different actions
            switch(type) {
                case 'message':
                    oscillator.frequency.value = 800;
                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                    break;
                case 'suggestion':
                    oscillator.frequency.value = 600;
                    gainNode.gain.setValueAtTime(0.05, audioContext.currentTime);
                    break;
                case 'error':
                    oscillator.frequency.value = 300;
                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                    break;
                case 'success':
                    oscillator.frequency.value = 1000;
                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                    break;
                case 'clear':
                    oscillator.frequency.value = 400;
                    gainNode.gain.setValueAtTime(0.05, audioContext.currentTime);
                    break;
                case 'enable':
                    oscillator.frequency.value = 900;
                    gainNode.gain.setValueAtTime(0.08, audioContext.currentTime);
                    break;
            }
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.1);
        } catch (e) {
            // Fallback for browsers that don't support Web Audio API
            console.log('Sound not supported');
        }
    }
    
    function typeMessage(element, text, callback) {
        // Simulate typing effect for more natural conversation
        let index = 0;
        element.innerHTML = '';
        
        function typeChar() {
            if (index < text.length) {
                element.innerHTML += text.charAt(index);
                index++;
                setTimeout(typeChar, 20 + Math.random() * 30); // Variable typing speed
            } else if (callback) {
                callback();
            }
        }
        
        typeChar();
    }
    
    async function sendMessageToAI(message) {
        if (isTyping) return; // Prevent multiple simultaneous requests
        
        isTyping = true;
        conversationCount++;
        
        try {
            // Show enhanced typing indicator
            showTypingIndicator();
            
            const response = await fetch('/donation2/chat/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                },
                body: `message=${encodeURIComponent(message)}&session_id=${Date.now()}`
            });
            
            const data = await response.json();
            
            // Remove typing indicator
            removeTypingIndicator();
            
            if (response.ok && data.message) {
                // Add message with typing effect
                const messageDiv = createMessageElement(data.message, false, data.suggestions || []);
                chatMessages.appendChild(messageDiv);
                
                // Scroll and play sound
                scrollToBottom();
                playSound('message');
                
                // Update conversation stats
                updateConversationStats();
                
            } else {
                handleError('Response error', data);
            }
        } catch (error) {
            console.error('Error:', error);
            removeTypingIndicator();
            handleError('Connection error', error);
        } finally {
            isTyping = false;
        }
    }
    
    function createMessageElement(content, isUser, suggestions = []) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${isUser ? 'user' : 'system'} fade-in`;
        
        const messageContent = document.createElement('div');
        messageContent.className = 'message-content';
        
        if (isUser) {
            messageContent.innerHTML = `
                <div class="user-message-wrapper">
                    <div class="user-avatar">üë§</div>
                    <div class="user-message">${content}</div>
                    <div class="message-time">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
                </div>
            `;
        } else {
            messageContent.innerHTML = `
                <div class="bot-message-wrapper">
                    <div class="bot-avatar">ü§ñ</div>
                    <div class="bot-message">${content}</div>
                    <div class="message-time">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
                </div>
            `;
        }
        
        messageDiv.appendChild(messageContent);
        
        // Add suggestions with enhanced styling
        if (!isUser && suggestions && suggestions.length > 0) {
            const suggestionsDiv = document.createElement('div');
            suggestionsDiv.className = 'suggestions-container';
            
            suggestions.forEach((suggestion, index) => {
                const btn = document.createElement('button');
                btn.className = 'suggestion-btn';
                btn.innerHTML = suggestion;
                btn.onclick = () => {
                    playSound('suggestion');
                    sendSuggestion(suggestion);
                };
                
                // Stagger animation for suggestions
                btn.style.animationDelay = `${index * 0.1}s`;
                suggestionsDiv.appendChild(btn);
            });
            
            messageDiv.appendChild(suggestionsDiv);
        }
        
        return messageDiv;
    }
    
    function showTypingIndicator() {
        const typingDiv = document.createElement('div');
        typingDiv.className = 'message system typing-message';
        typingDiv.innerHTML = `
            <div class="message-content">
                <div class="bot-message-wrapper">
                    <div class="bot-avatar">ü§ñ</div>
                    <div class="typing-indicator">
                        <span></span><span></span><span></span>
                        <span class="typing-text">AI is thinking...</span>
                    </div>
                </div>
            </div>
        `;
        chatMessages.appendChild(typingDiv);
        scrollToBottom();
    }
    
    function removeTypingIndicator() {
        const typingMessage = document.querySelector('.typing-message');
        if (typingMessage) {
            typingMessage.style.opacity = '0';
            setTimeout(() => {
                typingMessage.remove();
            }, 300);
        }
    }
    
    function scrollToBottom() {
        chatContainer.scrollTo({
            top: chatContainer.scrollHeight,
            behavior: 'smooth'
        });
    }
    
    function handleError(type, error) {
        console.error('Chat error details:', error);
        
        const errorMessages = [
            "üòÖ Oops! I had a tiny hiccup, but I'm back and ready to help!",
            "üîß Just a small technical moment - I'm all good now!",
            "üí´ Had a quick brain freeze, but I'm warmed up and ready!",
            "üöÄ Minor turbulence, but we're back on track!"
        ];
        
        const randomMessage = errorMessages[Math.floor(Math.random() * errorMessages.length)];
        
        addMessage(randomMessage + "\n\nüí™ **Don't worry!** I have multiple backup systems, so let's try again! What can I help you with?", false, [
            'üîÑ Try again',
            'üîç Check my fees',
            'üí∞ Show donations',
            'üìû Contact support',
            '‚ùì Help me'
        ]);
        
        playSound('error');
    }
    
    function updateConversationStats() {
        // Update header with conversation count
        const subtitle = document.querySelector('.ai-subtitle');
        if (conversationCount > 5) {
            subtitle.textContent = `Great conversation! ‚Ä¢ ${conversationCount} messages ‚Ä¢ Having fun? üòä`;
        } else if (conversationCount > 10) {
            subtitle.textContent = `Wow, we're chatting a lot! ‚Ä¢ ${conversationCount} messages ‚Ä¢ I love helping you! üíñ`;
        }
    }

    chatForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const query = userInput.value.trim();
        if (!query || isTyping) return;
        
        // Add user message with enhanced styling
        const userMessageDiv = createMessageElement(query, true);
        chatMessages.appendChild(userMessageDiv);
        userInput.value = '';
        
        // Play user message sound
        playSound('suggestion');
        
        // Send to AI
        await sendMessageToAI(query);
    });
    
    // Enhanced input features
    userInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            chatForm.dispatchEvent(new Event('submit'));
        }
    });
    
    // Smart input suggestions
    userInput.addEventListener('input', function() {
        const value = this.value.toLowerCase();
        
        // Show smart suggestions based on input
        if (value.length > 2) {
            showSmartSuggestions(value);
        } else {
            hideSmartSuggestions();
        }
    });
    
    function showSmartSuggestions(input) {
        const suggestions = {
            'fee': ['Check my fees', 'Payment methods', 'Fee waiver'],
            'pay': ['How to make payment?', 'Payment methods', 'Bank transfer guide'],
            'don': ['Show donation events', 'How to donate?', 'My donations'],
            'waq': ['What is waqaf?', 'Waqaf opportunities', 'How to contribute?'],
            'help': ['Help me', 'Contact support', 'System guide'],
            'prob': ['I have a problem', 'Technical issues', 'Payment problems']
        };
        
        for (let key in suggestions) {
            if (input.includes(key)) {
                // Show floating suggestions
                showFloatingSuggestions(suggestions[key]);
                break;
            }
        }
    }
    
    function showFloatingSuggestions(suggestions) {
        // Remove existing floating suggestions
        const existing = document.querySelector('.floating-suggestions');
        if (existing) existing.remove();
        
        const floatingDiv = document.createElement('div');
        floatingDiv.className = 'floating-suggestions';
        
        suggestions.forEach(suggestion => {
            const btn = document.createElement('button');
            btn.className = 'floating-suggestion-btn';
            btn.textContent = suggestion;
            btn.onclick = () => {
                userInput.value = suggestion;
                hideSmartSuggestions();
                chatForm.dispatchEvent(new Event('submit'));
            };
            floatingDiv.appendChild(btn);
        });
        
        userInput.parentNode.appendChild(floatingDiv);
    }
    
    function hideSmartSuggestions() {
        const floating = document.querySelector('.floating-suggestions');
        if (floating) floating.remove();
    }
    
    // Load user preferences
    const savedPrefs = localStorage.getItem('chatPreferences');
    if (savedPrefs) {
        userPreferences = JSON.parse(savedPrefs);
        soundEnabled = userPreferences.soundEnabled;
        
        // Update sound button
        const soundBtn = document.getElementById('soundToggle');
        if (soundBtn) {
            const icon = soundBtn.querySelector('i');
            if (!soundEnabled) {
                icon.className = 'fas fa-volume-mute';
                soundBtn.title = 'Sound OFF - Click to enable';
            }
        }
    }
});
</script>

<style>
/* World-Class AI Assistant Styling */
.ai-header {
    margin-bottom: 2rem;
}

.ai-logo {
    font-size: 4rem;
    margin-bottom: 1rem;
    animation: float 3s ease-in-out infinite;
}

.ai-title {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 800;
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
}

.ai-subtitle {
    color: #6c757d;
    font-size: 1.1rem;
    font-weight: 500;
}

.chat-card {
    background: white;
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.1);
    overflow: hidden;
    border: none;
}

.chat-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 1.5rem;
    border-bottom: none;
}

.bot-status-indicator {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    margin-right: 10px;
    animation: pulse 2s infinite;
}

.bot-status-indicator.online {
    background-color: #00ff88;
    box-shadow: 0 0 10px rgba(0,255,136,0.5);
}

.chat-container {
    background: linear-gradient(135deg, #f8f9ff 0%, #e8f4fd 100%);
    border-radius: 15px;
    padding: 25px;
    box-shadow: inset 0 2px 15px rgba(0,0,0,0.05);
    position: relative;
}

.message {
    margin-bottom: 25px;
    display: flex;
    flex-direction: column;
    animation: slideInUp 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.message.user {
    align-items: flex-end;
}

.message.system {
    align-items: flex-start;
}

.message-content {
    max-width: 90%;
    position: relative;
}

.user-message-wrapper, .bot-message-wrapper {
    display: flex;
    align-items: flex-start;
    gap: 12px;
}

.user-message-wrapper {
    flex-direction: row-reverse;
}

.user-message, .bot-message {
    padding: 18px 24px;
    border-radius: 25px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    position: relative;
    max-width: 500px;
    word-wrap: break-word;
    line-height: 1.6;
}

.user-message {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-bottom-right-radius: 8px;
}

.bot-message {
    background: white;
    color: #2c3e50;
    border: 1px solid #e8ecf0;
    border-bottom-left-radius: 8px;
    box-shadow: 0 4px 25px rgba(102, 126, 234, 0.1);
}

.user-avatar, .bot-avatar {
    font-size: 28px;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.user-avatar {
    background: linear-gradient(135deg, #ff7675 0%, #fd79a8 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(255, 118, 117, 0.3);
}

.bot-avatar {
    background: linear-gradient(135deg, #00cec9 0%, #55a3ff 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(0, 206, 201, 0.3);
    animation: botPulse 2s ease-in-out infinite;
}

.message-time {
    font-size: 0.75rem;
    color: #95a5a6;
    margin-top: 5px;
    text-align: center;
}

.bot-avatar, .user-avatar {
    font-size: 24px;
    margin-bottom: 8px;
}

.welcome-message {
    line-height: 1.6;
}

.welcome-message strong {
    color: #2c3e50;
    font-size: 1.1em;
}

.message-content ul {
    margin: 10px 0;
    padding-left: 20px;
}

.message-content li {
    margin-bottom: 5px;
}

/* Enhanced Suggestion System */
.suggestions-container {
    margin-top: 20px;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    animation: fadeInUp 0.5s ease-out;
}

.suggestion-btn {
    background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 25px;
    font-size: 0.9em;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    box-shadow: 0 4px 15px rgba(116, 185, 255, 0.2);
    position: relative;
    overflow: hidden;
}

.suggestion-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.5s;
}

.suggestion-btn:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 8px 25px rgba(116, 185, 255, 0.4);
}

.suggestion-btn:hover::before {
    left: 100%;
}

.suggestion-btn:active {
    transform: translateY(-1px) scale(1.02);
}

/* Floating suggestions for smart input */
.floating-suggestions {
    position: absolute;
    bottom: 100%;
    left: 0;
    right: 0;
    background: white;
    border-radius: 15px;
    box-shadow: 0 -5px 25px rgba(0,0,0,0.15);
    padding: 15px;
    margin-bottom: 10px;
    z-index: 1000;
    animation: slideUp 0.3s ease-out;
}

.floating-suggestion-btn {
    background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%);
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 20px;
    font-size: 0.85em;
    margin: 3px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.floating-suggestion-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 3px 10px rgba(108, 92, 231, 0.3);
}

/* Typing indicator */
.typing-indicator {
    display: flex;
    align-items: center;
    padding: 10px;
}

.typing-indicator span {
    height: 8px;
    width: 8px;
    background-color: #74b9ff;
    border-radius: 50%;
    display: inline-block;
    margin: 0 2px;
    animation: typing 1.4s infinite ease-in-out;
}

.typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
.typing-indicator span:nth-child(2) { animation-delay: -0.16s; }

@keyframes typing {
    0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
    40% { transform: scale(1); opacity: 1; }
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.input-group {
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    border-radius: 25px;
    overflow: hidden;
}

#userInput {
    border: none;
    padding: 15px 20px;
    font-size: 1.1em;
    background: white;
}

#userInput:focus {
    box-shadow: none;
    outline: none;
}

.btn-primary {
    border: none;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 15px 25px;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn-primary:hover {
    background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
    transform: translateY(-1px);
}

/* Enhanced Input Styling */
.input-group {
    box-shadow: 0 8px 30px rgba(0,0,0,0.1);
    border-radius: 30px;
    overflow: hidden;
    position: relative;
    background: white;
}

#userInput {
    border: none;
    padding: 18px 25px;
    font-size: 1.1em;
    background: transparent;
    color: #2c3e50;
    font-weight: 500;
}

#userInput:focus {
    box-shadow: none;
    outline: none;
    background: rgba(102, 126, 234, 0.02);
}

#userInput::placeholder {
    color: #bdc3c7;
    font-style: italic;
}

.btn-primary {
    border: none;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 18px 30px;
    font-weight: 600;
    font-size: 1.1em;
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    position: relative;
    overflow: hidden;
}

.btn-primary::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.6s;
}

.btn-primary:hover {
    background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
}

.btn-primary:hover::before {
    left: 100%;
}

.btn-primary:active {
    transform: translateY(0);
}

/* Animations */
@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

@keyframes botPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

@keyframes slideInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes typing {
    0%, 80%, 100% { 
        transform: scale(0.8); 
        opacity: 0.5; 
    }
    40% { 
        transform: scale(1.2); 
        opacity: 1; 
    }
}

/* Enhanced Typing Indicator */
.typing-indicator {
    display: flex;
    align-items: center;
    padding: 15px;
    gap: 8px;
}

.typing-indicator span {
    height: 10px;
    width: 10px;
    background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
    border-radius: 50%;
    display: inline-block;
    animation: typing 1.4s infinite ease-in-out;
}

.typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
.typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
.typing-indicator span:nth-child(3) { animation-delay: 0s; }

.typing-text {
    color: #74b9ff;
    font-style: italic;
    font-weight: 500;
    margin-left: 10px;
}

/* Responsive Design - Mobile First */
@media (max-width: 768px) {
    .ai-title {
        font-size: 2rem;
    }
    
    .ai-logo {
        font-size: 3rem;
    }
    
    .user-message, .bot-message {
        max-width: 280px;
        padding: 15px 18px;
        font-size: 0.95em;
    }
    
    .user-avatar, .bot-avatar {
        width: 35px;
        height: 35px;
        font-size: 20px;
    }
    
    .suggestion-btn {
        font-size: 0.8em;
        padding: 10px 16px;
    }
    
    .chat-container {
        padding: 15px;
    }
    
    #userInput {
        padding: 15px 20px;
        font-size: 1em;
    }
    
    .btn-primary {
        padding: 15px 20px;
        font-size: 1em;
    }
}

@media (max-width: 480px) {
    .user-message, .bot-message {
        max-width: 250px;
        padding: 12px 15px;
        font-size: 0.9em;
    }
    
    .suggestions-container {
        gap: 6px;
    }
    
    .suggestion-btn {
        font-size: 0.75em;
        padding: 8px 12px;
    }
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
    .chat-container {
        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
    }
    
    .bot-message {
        background: #34495e;
        color: #ecf0f1;
        border-color: #4a5f7a;
    }
    
    .ai-subtitle {
        color: #bdc3c7;
    }
}

/* Accessibility improvements */
.suggestion-btn:focus,
.btn-primary:focus,
#userInput:focus {
    outline: 3px solid rgba(102, 126, 234, 0.3);
    outline-offset: 2px;
}

/* Print styles */
@media print {
    .chat-header,
    .input-group,
    .suggestions-container {
        display: none;
    }
    
    .message-content {
        box-shadow: none;
        border: 1px solid #ddd;
    }
}
</style>
{% endblock %}
{% endblock %} 