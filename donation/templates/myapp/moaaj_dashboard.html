{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>

<!-- Embed payment data safely -->
{{ [total_paid|default:0, pending_payments|default:0, overdue_payments|default:0]|json_script:"payment_status_data" }}

<script>
// Payment Trends Chart
const trendsCtx = document.getElementById('paymentTrendsChart').getContext('2d');
new Chart(trendsCtx, {
    type: 'line',
    data: {
        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
        datasets: [{
            label: 'Payments',
            data: [12, 19, 15, 25, 22, 18, 30],
            borderColor: '#667eea',
            backgroundColor: 'rgba(102, 126, 234, 0.1)',
            tension: 0.4,
            fill: true
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
            y: { beginAtZero: true }
        }
    }
});

// Payment Status Chart
const statusCtx = document.getElementById('paymentStatusChart').getContext('2d');

// Load safe JSON data
const paymentStatusData = JSON.parse(document.getElementById('payment_status_data').textContent);

new Chart(statusCtx, {
    type: 'doughnut',
    data: {
        labels: ['Paid', 'Pending', 'Overdue'],
        datasets: [{
            data: paymentStatusData,
            backgroundColor: ['#28a745', '#ffc107', '#dc3545']
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { position: 'bottom' } }
    }
});
</script>
{% endblock %}
